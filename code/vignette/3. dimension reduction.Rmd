---
title: "Dimension reduction"
output: 
rmarkdown::html_vignette: 
toc: true
fig_width: 7 
fig_height: 8 
vignette: >
  %\VignetteIndexEntry{Dimension reduction}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---
<style>
p.caption {
  font-size: 1.5em;
}
</style>
```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


## Introduction

Our goal here is to produce an informative UMAP. To get there, we'll also use PCA to get a reduced-dimension dataset,
and we'll try UMAP under a few parameterizations to see what works best.

```{r prepforumap}
# load data:
norm <- readRDS("processed_data/norm.RDS")

# run PCA:
pca_result <- irlba::irlba(norm, nv = 25)
# Get the top principal components (scores)
pc <- pca_result$u %*% diag(pca_result$d)

# run UMAP:
um <- uwot::umap(pc)

# plot it:
par(mar= c(0,0,0,0))
plot(um, pch = 16, cex = 0.1, col = "dodgerblue4")

# save:
saveRDS(um, paste0(mydir, "/processed_data/um.RDS"))
```


## 



